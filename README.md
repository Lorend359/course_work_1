# Анализ транзакций

## Описание проекта

Приложение для анализа финансовых транзакций из Excel-файлов, формирования JSON-ответов для веб-страниц, создания отчетов и предоставления поисковых сервисов. Оно предоставляет удобный способ обработки данных о транзакциях, анализе расходов и генерации полезной информации, такой как курсы валют и цены акций.

---

## Основные модули

### 1. `views`

Модуль для генерации JSON-ответов, используемых веб-страницей. Он включает:

- Приветствие в зависимости от времени суток.
- Статистику по картам (последние 4 цифры, общие траты, кешбэк).
- Топ-5 транзакций по сумме.
- Курсы валют.
- Цены акций из S&P500.

**Основные функции:**

- `get_greeting`: Формирует приветствие на основе текущего времени.
- `get_card_statistics`: Генерирует статистику по картам.
- `get_top_transactions`: Находит топ-N транзакций по сумме.
- `main`: Главная функция, объединяющая весь функционал и возвращающая JSON-ответ.

### 2. `services`

Модуль для предоставления сервисов поиска транзакций.

**Основные функции:**

- `search_transactions`: Выполняет поиск по строке запроса в описании и категории транзакций. Возвращает JSON-ответ с найденными транзакциями.

### 3. `reports`

Модуль для генерации отчетов с использованием декораторов.

**Основные функции:**

- В`default_report_decorator`: Декоратор без параметров. Сохраняет результат функции в файл с именем по умолчанию.
- `param_report_decorator`: Декоратор с параметром, принимающий имя файла для сохранения.
- `spending_by_category`: Генерирует отчет о тратах по категории за последние три месяца.

### 4. `utils`

Вспомогательный модуль для работы с данными.

**Основные функции:**

- `load_user_settings`: Загружает настройки пользователя из JSON-файла.
- `filter_transactions_by_date`: Фильтрует транзакции по указанному диапазону дат.
- `fetch_currency_data`: Получает курсы валют через API.
- `fetch_stock_data`: Получает текущие цены на акции через API.

---

## Тестирование

Для каждого модуля реализованы тесты с использованием `pytest`. Они проверяют корректность работы основных функций, включая обработку данных, фильтрацию и интеграцию с API.



---

## Установка и запуск

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/Lorend359/course_work_1.git
   ```

2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

3. Настройте переменные окружения (например, API\_KEY).

4. Запустите приложение:

   ```bash
   python main.py
   ```

---

## Пример использования

### Главная страница

- Пример JSON-ответа для главной страницы:
  ```json
  {
      "greeting": "Добрый день",
      "cards": [
          {
              "card_number": "1234",
              "total_spent": 1000,
              "cashback": 10
          }
      ],
      "top_transactions": [
          {
              "date": "2021-12-31",
              "amount": 500,
              "category": "Супермаркеты",
              "description": "Покупка продуктов"
          }
      ],
      "currency_rates": [
          {"currency": "USD", "rate": 73.5}
      ],
      "stock_prices": [
          {"stock": "AAPL", "price": 150.0}
      ]
  }
  ```

### Поиск транзакций

- Пример JSON-ответа для поиска по строке "Колхоз":
  ```json
  {
      "search_query": "Колхоз",
      "count": 2,
      "results": [
          {
              "date": "2021-12-01",
              "category": "Сельское хозяйство",
              "description": "Колхоз",
              "amount": 500
          }
      ]
  }
  ```


